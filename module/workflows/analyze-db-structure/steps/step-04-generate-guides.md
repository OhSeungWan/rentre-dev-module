---
name: 'step-04-generate-guides'
description: 'ê°€ì´ë“œ ë¬¸ì„œ ìƒì„±'

# Path Definitions
workflow_path: '{module_path}/workflows/analyze-db-structure'

# File References
thisStepFile: '{workflow_path}/steps/step-04-generate-guides.md'
nextStepFile: '{workflow_path}/steps/step-05-complete.md'
workflowFile: '{workflow_path}/workflow.md'

# Output References
guides_folder: '{module_path}/data/guides'
output_template: '{workflow_path}/templates/guide-summary.md'
---

# Step 4: ê°€ì´ë“œ ë¬¸ì„œ ìƒì„±

**Progress: Step 4 of 5** - Next: ì™„ë£Œ ë° ê²€ì¦

## STEP GOAL:

ë¶„ì„ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì—ì´ì „íŠ¸ìš© ê°€ì´ë“œ ë¬¸ì„œë“¤ì„ ìƒì„±í•©ë‹ˆë‹¤.

## MANDATORY EXECUTION RULES (READ FIRST):

### Universal Rules:

- ğŸ›‘ NEVER generate content without user input
- ğŸ“– CRITICAL: Read the complete step file before taking any action
- ğŸ”„ CRITICAL: When loading next step with 'C', ensure entire file is read
- ğŸ“‹ YOU ARE A FACILITATOR, not a content generator

### Role Reinforcement:

- âœ… You are a ë°ì´í„°ë² ì´ìŠ¤ ë¶„ì„ ì „ë¬¸ê°€
- âœ… We engage in collaborative dialogue, not command-response
- âœ… You bring ë¬¸ì„œí™” ì „ë¬¸ì„±, user brings íŒ€ ìš”êµ¬ì‚¬í•­

### Step-Specific Rules:

- ğŸ¯ Focus on ë¬¸ì„œ ìƒì„± - ê° ë¬¸ì„œ ì™„ë£Œ í›„ ì§„í–‰
- ğŸš« FORBIDDEN to skip any guide document
- ğŸ’¬ Show each document and ask for confirmation
- ğŸ“ Ensure guides_folder exists before writing

## EXECUTION PROTOCOLS:

- ğŸ¯ ì¶œë ¥ ë””ë ‰í† ë¦¬ ë¨¼ì € í™•ì¸/ìƒì„±
- ğŸ’¾ ê° ë¬¸ì„œ ìƒì„± í›„ ì €ì¥
- ğŸ“– ì‚¬ìš©ìì—ê²Œ ë¬¸ì„œ ë‚´ìš© í™•ì¸ ë°›ê¸°
- ğŸš« FORBIDDEN ë¬¸ì„œ ìƒì„± ì‹¤íŒ¨ ë¬´ì‹œ ê¸ˆì§€

## CONTEXT BOUNDARIES:

- Available context: ìŠ¤í‚¤ë§ˆ ë¶„ì„ + ê³„ì¸µ ë§¤í•‘ ê²°ê³¼
- Focus: ê°€ì´ë“œ ë¬¸ì„œ ìƒì„±
- Limits: ê²€ì¦ì€ ë‹¤ìŒ ìŠ¤í…ì—ì„œ ìˆ˜í–‰
- Dependencies: step-02, step-03 ì™„ë£Œ

---

## Sequence of Instructions (Do not deviate, skip, or optimize)

### 1. ì¶œë ¥ ë””ë ‰í† ë¦¬ í™•ì¸

```yaml
action:
  - Check if {guides_folder} exists
  - If not exists: Create directory
  - Confirm write permissions
```

**If directory creation fails:**

> "**âš ï¸ ê°€ì´ë“œ í´ë” ìƒì„± ì‹¤íŒ¨**
>
> ê²½ë¡œ: {guides_folder}
>
> ìˆ˜ë™ìœ¼ë¡œ í´ë”ë¥¼ ìƒì„±í•˜ê±°ë‚˜ ê¶Œí•œì„ í™•ì¸í•´ ì£¼ì„¸ìš”."

**â†’ [R] Retry ì˜µì…˜ ì œì‹œ**

### 2. Summary Guide ìƒì„±

**íŒŒì¼:** `{guides_folder}/backlog-guide-summary.md`

#### A. ë¬¸ì„œ ë‚´ìš© êµ¬ì„±

```markdown
# Backlog Guide Summary

> Generated by Rentre-Dev on {date}
> Database: {database_name}

## Overview

| í•­ëª©              | ê°’                 |
| ----------------- | ------------------ |
| ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„ | {database_name}    |
| ë°ì´í„°ë² ì´ìŠ¤ ID   | {database_id}      |
| ë°±ë¡œê·¸ ìœ í˜• ìˆ˜    | {types_count}      |
| ì „ì²´ ì†ì„± ìˆ˜      | {properties_count} |
| ê´€ê³„ ì†ì„± ìˆ˜      | {relations_count}  |

## Backlog Types

{types_table}

## Hierarchy
```

{hierarchy_diagram}

```

## Properties Reference

### Core Properties
{core_properties_table}

### Relation Properties
{relation_properties_table}

## Agent Navigation Guide

{navigation_quick_reference}
```

#### B. ë¬¸ì„œ ì €ì¥ ë° í‘œì‹œ

ë¬¸ì„œ ë‚´ìš©ì„ ì €ì¥í•˜ê³  ì‚¬ìš©ìì—ê²Œ í‘œì‹œ:

> "**ğŸ“„ Summary Guide ìƒì„±ë¨**
>
> íŒŒì¼: `backlog-guide-summary.md`
>
> {document_preview}
>
> ë‚´ìš©ì´ ì ì ˆí•œê°€ìš”?"

**Wait for user confirmation.**

### 3. Hierarchy Map ìƒì„±

**íŒŒì¼:** `{guides_folder}/hierarchy-map.md`

#### A. ë¬¸ì„œ ë‚´ìš© êµ¬ì„±

```markdown
# Backlog Hierarchy Map

> Generated by Rentre-Dev on {date}

## Visual Hierarchy
```

{hierarchy_diagram_detailed}

````

## Relation Property Mappings

| ê´€ê³„ ì†ì„± | ì—°ê²° ë°©í–¥ | ì„¤ëª… |
| --------- | --------- | ---- |
{relation_mappings_table}

## Navigation Flowchart

### Finding Parent Items
1. Get current item's "{parent_relation}" property
2. Query database with ID from relation

### Finding Child Items
1. Query database
2. Filter: "{child_relation}" contains current item ID

## Cross-Reference Table

{cross_reference_table}

## Agent Usage Examples

### Example: Find all Tasks under a Story
```yaml
action:
  tool: mcp__notionApi__API-post-database-query
  params:
    database_id: {database_id}
    filter:
      property: "{parent_relation}"
      relation:
        contains: "{story_id}"
````

````

#### B. ë¬¸ì„œ ì €ì¥ ë° í‘œì‹œ

> "**ğŸ“„ Hierarchy Map ìƒì„±ë¨**
>
> íŒŒì¼: `hierarchy-map.md`
>
> {document_preview}"

### 4. Type-Specific Guides ìƒì„±

ì‹ë³„ëœ ê° ë°±ë¡œê·¸ ìœ í˜•ë³„ ê°€ì´ë“œ ìƒì„±:

**íŒŒì¼ íŒ¨í„´:** `{guides_folder}/guide-{type_lowercase}.md`

#### A. ê° ìœ í˜•ë³„ ë¬¸ì„œ êµ¬ì„±

```markdown
# {Type} Guide

> Generated by Rentre-Dev on {date}

## Overview

- **ìœ í˜•:** {type_name}
- **ëª©ì :** {type_purpose}
- **ê³„ì¸µ ìœ„ì¹˜:** {hierarchy_position}

## Required Fields

| í•„ë“œ | íƒ€ì… | ì„¤ëª… |
| ---- | ---- | ---- |
{required_fields_table}

## Optional Fields

{optional_fields_table}

## Parent/Child Relationships

### Parent
- ìœ í˜•: {parent_type}
- ê´€ê³„ ì†ì„±: {parent_relation}

### Children
- ìœ í˜•: {child_types}
- ê´€ê³„ ì†ì„±: {child_relation}

## Status Workflow

{status_workflow_diagram}

## Notion MCP API Examples

### Find all {type_name}s
```yaml
tool: mcp__notionApi__API-post-database-query
params:
  database_id: {database_id}
  filter:
    property: "Type"
    select:
      equals: "{type_name}"
````

### Create new {type_name}

```yaml
tool: mcp__notionApi__API-post-page
params:
  parent:
    database_id: { database_id }
  properties:
    # ... required properties
```

## Best Practices

{type_best_practices}

```

#### B. ì§„í–‰ ìƒí™© í‘œì‹œ

ê° ìœ í˜•ë³„ ê°€ì´ë“œ ìƒì„± ì‹œ:

> "**ğŸ“„ {Type} Guide ìƒì„±ë¨** ({current}/{total})
>
> íŒŒì¼: `guide-{type}.md`"

### 5. ìƒì„± ì™„ë£Œ ë³´ê³ 

ëª¨ë“  ë¬¸ì„œ ìƒì„± í›„ ìš”ì•½:

> "**âœ… ê°€ì´ë“œ ë¬¸ì„œ ìƒì„± ì™„ë£Œ**
>
> â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
>
> **ìƒì„±ëœ íŒŒì¼:**
>
> 1. `backlog-guide-summary.md` - ì „ì²´ ìš”ì•½
> 2. `hierarchy-map.md` - ê³„ì¸µ êµ¬ì¡° ë§µ
> {type_guides_list}
>
> **ì´ {total_files}ê°œ íŒŒì¼ ìƒì„±ë¨**
>
> ê²½ë¡œ: `{guides_folder}/`
>
> â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"

---

### 6. Present MENU OPTIONS

Display: "**Select an Option:** [C] Continue - ì™„ë£Œ ë° ê²€ì¦ [V] View - íŒŒì¼ ë‚´ìš© í™•ì¸ [R] Regenerate - ë‹¤ì‹œ ìƒì„± [X] Exit - ì¢…ë£Œ"

#### Menu Handling Logic:

- IF C: Load, read entire file, then execute {nextStepFile}
- IF V: Show list of files, let user select one to view
- IF R: Re-execute from section 1
- IF X: End workflow with summary
- IF Any other comments or queries: help user respond then redisplay menu

#### EXECUTION RULES:

- ALWAYS halt and wait for user input after presenting menu
- ONLY proceed to next step when user selects 'C'
- After other menu items execution, return to this menu

---

## CRITICAL STEP COMPLETION NOTE

ONLY WHEN [C continue option] is selected and [ëª¨ë“  ê°€ì´ë“œ ë¬¸ì„œê°€ ìƒì„±ë¨], will you then load and read fully `{nextStepFile}` to execute and begin ì™„ë£Œ ë° ê²€ì¦ ë‹¨ê³„.

---

## ğŸš¨ SYSTEM SUCCESS/FAILURE METRICS

### âœ… SUCCESS:

- ì¶œë ¥ ë””ë ‰í† ë¦¬ í™•ì¸/ìƒì„± ì™„ë£Œ
- Summary Guide ìƒì„± ë° ì €ì¥
- Hierarchy Map ìƒì„± ë° ì €ì¥
- ëª¨ë“  Type Guide ìƒì„± ë° ì €ì¥
- ì‚¬ìš©ì í™•ì¸ ì™„ë£Œ

### âŒ SYSTEM FAILURE:

- ë””ë ‰í† ë¦¬ ìƒì„± ì‹¤íŒ¨ ë¬´ì‹œ
- ë¬¸ì„œ ìƒì„± ëˆ„ë½
- ì €ì¥ ì‹¤íŒ¨ ë¬´ì‹œ
- ì‚¬ìš©ì í™•ì¸ ì—†ì´ ì§„í–‰
- **CRITICAL**: ìŠ¤í… íŒŒì¼ ì¼ë¶€ë§Œ ì½ìŒ

**Master Rule:** Skipping steps, optimizing sequences, or not following exact instructions is FORBIDDEN and constitutes SYSTEM FAILURE.
```
